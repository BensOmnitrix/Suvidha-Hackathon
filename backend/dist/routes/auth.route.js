import { Router } from "express";
import { otpLimiter } from "../middlewares/rateLimiters.js";
import { sendOtpSchema, signinSchema, signupSchema } from "../validators/auth.validators.js";
import { sendOTP, signup } from "../controllers/auth/signup.controller.js";
import { asyncHandler } from "../utils/asyncHandler.js";
import { validate } from "../middlewares/validate.middleware.js";
import { signin } from "../controllers/auth/signin.controller.js";
import { authenticate } from "../middlewares/auth.middleware.js";
import { logout } from "../controllers/auth/logout.controller.js";
export const authRouter = Router();
authRouter.post("/otp", otpLimiter, validate(sendOtpSchema), asyncHandler(sendOTP));
authRouter.post("/signup", validate(signupSchema), asyncHandler(signup));
authRouter.post("/signin", validate(signinSchema), asyncHandler(signin));
authRouter.post("/logout", authenticate, asyncHandler(logout));
